## cv
Логин и пароль для входа в демо приложение которое находится по адресу http://comprenova.ru Login: user@user.loc password: 12345678

Приложение является элементарным блогом с помощью которого продемонстрировны возможности Laravel для написания кода, 
следование принципам SOLID, применение паттернов проектирования, базовые навыки работы с фронтенд технологиями, навыки 
построения оптимальной схемы БД.

В демо приложении реализованы следующие вещи

1. Принципы SOLID Контроллеры реализуют только прием Request и отдачу Response, валидация 
вынесена в отдельный класс, логика вынесена в сервисные классы, с помощью паттерна Репозиторий 
реализована инверсия зависимостей что сделало код приложения независимым от типа хранилища. Это 
делает приложение хорошо подготовленным к развитию, вы можете спокойно расширять сервисный слой необходимым функционалом, т.к.
этот слой является слабо связанным с другими частями приложения. Таким образом, развитие приложения может 
идти последовательно и без проблем.

2. На примере реализации мультиязычности (можно добавлять неограниченное число языков) показаны возможности
Laravel по переводам статического контента, но что более интересно как спроектирована схема БД для хранения
мультиязычного динамического контента. Кроме того, реализовано взаимодействие с JS плагинами для передачи в них
мультиязычного контента (DataTable, Dropzone и проч). 

3. Админка собрана на bootstrap 4, написаны JS модули для конфигурирования и подключения jQuery плагинов

В перспективе планируется добавить функционал для деплоя на удаленный сервер с нулевым временем простоя.

Написать REST API для обращения к блогу из внешних сервисов.

## Создание API приложения

Весь процесс состоит из пяти частей

- Написание JSON:API Спецификации
- Планирование нашего API
- Выбор системы аутентификации
- Написание кода API
- Написание тестов для API

Далее рассмотрим каждую часть подробнее

## JSON:API спецификация

- Спецификация преследует цель уменьшить количество запросов и объем передаваемых данных без ущерба для 
читабельности, гибкости и однозначности понимания.
- Спецификация описывает то, как клиент должен запрашивать ресурсы для извлечения или модификации и как 
сервер должен отвечать на запросы клиента
- JSON:API для изменения данных требует JSON:API media type (application/vnd.api+json)

Подробно ознакомиться с JSON:API спецификацией можно здесь [jsonapi.org](https://jsonapi.org/)

## Планирование API

В приложении определены следующие ресурсы: 

- `categories` - категории для статей блога
- `tags` - теги для статей блога
- `users` - пользователи блога
- `posts` - статьи блога
- `roles` - роли для пользователей
- `permissions` - права доступа для ролей

Существует одна тонкость это мультиязычность приложения. Например, сама категория храниться в таблице 
`categories` и относится к одноименному ресурсу, а переводы храняться в таблице `category_translations` 
и эти таблицы находятся в отношении один-ко-многим. При этом `category_translations` не является 
самостоятельным ресурсом. Тот или иной перевод должен быть обязательно представлен при запросе ресурса 
`categories`, а сам перевод отдельно не имеет смысла т. к. он имеет смысл только вместе с конкретной 
одной категорией и не может быть связан с другими. 

Этот момент будет отражен в структуре документа (JSON объекта) для извлечения и модификации ресурса 
`categories`. Там где будут выводится атрибуты ресурса, будет добавлен атрибут `translation` с 
вложенным в него массивом атрибутов, принадлежащих переводу в соответствии с запросом

Перечисленные выше ресурсы находятся друг с другом в следующих отношениях:

- `users` и `posts` - один ко многим
- `users` и `roles` - многие ко многим
- `roles` и `permissions` - один ко многим
- `categories` и `posts` - один ко многим
- `tags` и `posts` - многие ко многим

## Выбор системы аутентификации

## Написание кода



## Написание тестов

Написание тестов по объему кода не уступает коду самого приложения. Однако это с лихвой окупается позже 
при поддержке приложения, отлавливания багов при создании нового функционала и рефакторинге.

Тесты бывают двух видов: Unit Test и Feature Test. Первый вид тестирует отдельный объект вне его 
взаимосвязи с остальным приложением, а второй, так называемый, интеграционный тест для проверки работы
отдельного функционала приложения с задействованием всех участвующих в нем объектов. Можно сказать мы 
тестируем `endpoints` нашего API.

Для проведения тестов без измения состояния сервисов (БД например) рабочего окружения, настраивается 
тестовое окружение.

### Unit Tests

`EnsureCorrectAPIHeadersTest.php` тестируем работу созданного нами middleware `EnsureCorrectAPIHeaders`, 
который следит за корректностью заголовков `Accept` и `Content-type` запроса, и в случае их 
некорректности выдает 406 и 415 ошибки.

`HandlerTest.php` тестирует обработчик исключений `Handler.php` на предмет соответствия оформления 
вывода ошибок спецификации API.

### Feature Tests

Для удобства мы сгруппируем Feature Tests в файлы по их принадлежности к ресурсу и функционалу. Каждый 
тест буде состоять из трех частей:

- Устанавливаем все необходимое для проведения теста
- Запускаем тестируемый код
- Делаем все `assert`

##### categories resource

1. файл `CategoriesCRUDTest.php` включает набор тестов для CRUD операций с ресурсом `categories`
2. файл `CategoriesParametersTest.php` включает набор тестов для проверки работы ресурса `categories` 
при наличии в запросе параметров, указывающих на то, чтобы произвести сортировку, фильтрацию, пагинацию 
и т.д.
3. файл `CategoriesStoreValidation` включает набор тестов для проверки корректной валидации запроса 
на создание ресурса `categories`
4. файл `CategoriesUpdateValidation` включает набор тестов для проверки корректной валидации запроса 
на изменение ресурса `categories`
5. 
   
##### tags resource

##### posts resource
